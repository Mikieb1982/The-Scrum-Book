

import React, { useMemo } from 'react';
import type { AttendedMatch } from '../types';
import { VENUE_LOCATIONS } from '../services/mockData';

interface VisitMapViewProps {
    attendedMatches: AttendedMatch[];
}

const greatBritainPath = "M206.2,21.3c-2.3-0.2-4.6,0.3-6.6,1.4c-2,1.1-3.6,2.7-4.8,4.7c-1.2,2-1.9,4.3-2.2,6.7c-0.3,2.4-0.1,4.9,0.5,7.2 c0.6,2.4,1.8,4.6,3.3,6.5c1.5,1.9,3.4,3.5,5.6,4.7c2.2,1.2,4.6,1.9,7.1,2c2.5,0.1,5-0.4,7.2-1.4c2.2-1,4.2-2.5,5.7-4.5 c1.5-2,2.6-4.3,3.2-6.8c0.6-2.5,0.7-5,0.3-7.5c-0.4-2.5-1.3-4.9-2.7-7.1c-1.4-2.2-3.2-4.1-5.4-5.5c-2.2-1.4-4.7-2.3-7.3-2.6 C208.5,21.3,207.3,21.2,206.2,21.3z M125.4,62.8l-4.5-0.1l-2.1,3.3l2.8,2.1l-0.8,3.5l-3.5-0.5l-2.1,3.2l2.3,2.9l-2.4,3.1l-3.3-0.6 l-2.8,2.7l-0.1,3.8l-3.2,2.1l2.5,3.3l-2,2.4l-3-1.1l-3.4,3.8l-4,1.3l-1.3,3.7l-4.3,2.2l-0.5,2.9l-4.4,2.9l-1.1,3.4l-4.1,2.2 l-1.1,2.3l-5.3,0.7l-1.7,2.5l-4.7,0.4l-2.3,2.3l-5,0.7l-2.5,1.9l-5.6-2.1l-2.3,1.5l-4.4-1.7l-3.7,2.5l-4.5-1.7l-2.5,2.7l-4.5-2.2 l-1.8,2.2l-3.3-2.1l-1.5,2.5l-3.4-0.8l-1,3.2l-4.2,1.2l-2.3,3.3l-3.2,0.9l-1.8,3.8l-3.2,2.4l-1.7,4.2l-3,0.2l-0.5,3.6l-3.1,3.1 l-1.1,3.2l-3.7,2.7l-1.4,2.6l-3.3,1.7l-1.5,3.3l-2.5,1.5l0.2,3.3l-2.1,1.9l0,4.2l-2.1,1.7l-0.4,2.3l-2.3,1.4l-0.4,2.5l-2,1.2 l-1.1,2.3l-2.3,1.1l-0.8,2.5l-2,0.9l-0.4,3l-2.2,1.7l-1.3,4.2l-2,1.2l-0.5,2.9l-1.3,1.1l-0.4,2.7l2.8,2.5l-0.9,2.8l-3.1-0.2 l-1.2,3.3l-2.5,0.1l-1.1,2.7l-2.2,0.7l-1.1,2.4l-2,0.2l-0.7,2.5l1.5,2.5l-0.9,3.7l-2.7,2.1l-2.3,3.7l-2.4,1.4l-0.2,3.7 l0.5,2.1l-1.5,2.5l-0.5,2.8l0.9,2.3l-1.3,2.1l0.2,3l1.1,1.9l-0.5,2.5l1.1,2.3l0.4,3.1l2.5,2.5l0.1,2.8l2.5,2.7l1.3,3l2,1.4 l1.1,3.2l2.3,1.1l1,2.8l2.5,1.5l1.9,3.8l2,1.5l1.8,3.3l3,2.4l2,3.3l2.8,1.4l1.3,3.4l2.8,2.1l2.3,3.7l3,1.2l1.3,3.7l3,2.2l2.3,3.3 l2.2,1.4l1.1,3.8l2.8,1.5l1,3.3l2.5,2l1.3,3.2l2.7,1.8l1.4,3.3l2.4,1.3l0.8,4l2.1,1.9l1.1,3.6l2.1,1.8l1,3.3l2.1,1.9l0.9,3.4 l1.3,1.4l-0.4,3.3l1.3,1.7l0.2,3.6l1.5,1.7l0.1,3l1.1,1.4l0.8,3.7l2,1.8l1.7,3.5l2.4,1.3l1,3.4l2.5,2.1l1.1,3.4l2.4,1.7l1,3.4 l2.1,1.1l0.1,3.7l2,2.3l1.1,3.4l2.1,1.8l0.9,3.2l1.8,1.4l0.4,3.3l1.7,2.2l0.9,3.3l1.7,1.6l0.2,3.3l2.1,2.4l2.7,4l2.3,2l2.8,0.7 l1.3-1.8l2.1-0.2l1.3-2.2l2.1-0.5l1.3-2.2l1.7-0.2l0.8-2.3l1.7-0.9l1.1-2.5l1.8-0.9l1.1-2.4l1.4-0.4l0.7-3l1.8-1.7l1.4-3.4 l1.7-1.4l0.7-3.3l1.7-1.9l0.8-3.4l1.7-1.9l1.1-3.6l1.7-1.8l0.4-3.5l1.7-2.3l1.3-3.8l1.7-1.9l0.5-3.3l0.4-3.6l-0.4-3.1 l0.4-3.4l-0.2-3.2l0.9-3.4l-0.2-3.3l0.8-3.4l-0.2-3.3l1.3-3.1l0.2-3.4l1.3-3.1l0.1-3.6l1.7-2.8l0.5-3.5l1.7-2.7l0.2-3.6l1.8-3 l0.7-3.8l2-2.5l0.1-3.7l1.8-3l0.7-4l2-2.5l0.2-3.9l1.5-2.8l0.1-4l2-3.4l0.8-4.2l2-2.7l-0.2-4.1l1.7-3.4l0.1-4l1.3-2.7l-0.1-4.2 l1.7-3.7l0.7-4.3l1.8-3.1l-0.4-4.2l1.4-3.3l-0.2-4.2l1-2.8l-0.9-4.2l1.8-3.7l-0.1-4.3l1.1-3l-0.9-4.3l1.3-3.3l-1.3-4.3l1-3 l-1.5-4.5l1.5-3.7l-1.5-4.5l0.9-3.2l-2.1-4.4l0.8-3.3l-2-4.2l0.4-3.6l-2-4.4l-0.2-3.9l-2.1-4l-0.5-4l-2.2-3.8l-1.3-4.4l-2.3-3 l-1.3-4.4l-2.7-3.7l-2-4.5l-2.8-3.3l-1.4-4.7l-3.3-3.7l-2-4.7l-3.6-2.7l-1.4-4.7l-3.9-3.5l-2.5-5.2l-4-2.8l-1.7-5.2l-4.2-3.8 l-2.5-5.6l-4.5-2.8l-1.1-5.6l-4.9-4.1l-2.7-5.9l-4.8-2.7l-1.1-5.7l-5.3-4.7l-3.2-6.5l-5.3-2.3l-1-5.7l-5.7-4.8l-3.2-6.5l-5.6-2 l-0.7-5.9l-6.1-5l-3.6-7l-6-1.5l-0.2-6.1l-6.5-5.4l-3.9-7.2l-6.5-0.9l-0.1-6.1l-6.8-5.7l-4.1-7.5l-6.8-0.2l-0.1-6.3l-7.2-6 l-4.4-7.8l-7.1,0.4l-0.1-6.3l-7.5-6.3l-4.7-8.1l-7.5,1.1l-0.2-6.5l-7.8-6.6l-4.9-8.5l-7.8,1.8l-0.4-6.6l-8.2-6.9l-5.1-8.8 l-8.1,2.5l-0.5-6.8l-8.5-7.1l-5.4-9.1l-8.5,3.2l-0.7-6.9l-8.8-7.4l-5.6-9.5l-8.8,3.9l-0.8-7l-9.1-7.7l-5.8-9.8l-9,4.5 l-1-7.2l-9.4-7.9l-6-10.2l-9.4,5.2l-1.2-7.4l-9.7-8.2l-6.3-10.5l-9.7,5.8l-1.3-7.5l-10-8.5l-6.5-10.8l-10,6.4l-1.5-7.7 l-10.3-8.8l-6.7-11.1l-10.2,7l-1.7-7.8l-10.6-9l-6.9-11.4l-10.5,7.5l-1.8-8l-10.9-9.3l-7.1-11.7l-10.8,8.1l-2-8.1 l-11.2-9.6l-7.3-12l-11.1,8.6l-2.2-8.3l-11.5-9.9l-7.5-12.3l-11.4,9.1l-2.3-8.5l-11.8-10.2l-7.7-12.6l-11.7,9.6l-2.5-8.6 l-12.1-10.5l-7.9-12.9l-12,10.1l-2.7-8.8l-12.4-10.8l-8.1-13.2l-12.3,10.6l-2.8-9l-12.7-11l-8.3-13.5l-12.6,11.1l-3-9.1 l-13-11.3l-8.5-13.8l-12.9,11.6l-3.2-9.3l-13.3-11.6l-8.7-14.1l-13.2,12l-3.3-9.5l-13.6-11.9l-8.9-14.4l-13.5,12.5 l-3.5-9.6l-13.9-12.2l-9.1-14.7l-13.8,12.9l-3.7-9.8l-14.2-12.5l-9.3-15l-14.1,13.4l-3.8-9.9l-14.5-12.8l-9.5-15.3 l-14.4,13.8l-4-10.1l-14.8-13.1l-9.7-15.6l-14.7,14.3l-4.2-10.2l-15.1-13.4l-9.9-15.9l-15,14.7l-4.3-10.4l-15.4-13.7 l-10.1-16.2l-15.3,15.2l-4.5-10.5l-15.7-14l-10.3-16.5l-15.6,15.6l-4.7-10.7l-16-14.3l-10.5-16.8l-15.9,16.1l-4.8-10.8 l-16.3-14.6l-10.7-17.1l-16.2,16.5l-5-11l-16.6-14.9l-10.9-17.4l-16.5,16.9l-5.2-11.1l-16.9-15.2l-11.1-17.7l-16.8,17.4 l-5.3-11.3l-17.2-15.5l-11.3-18l-17.1,17.8l-5.5-11.4l-17.5-15.8l-11.5-18.3l-17.4,18.2l-5.7-11.6l-17.8-16.1l-11.7-18.6 l-17.7,18.6l-5.8-11.7l-18.1-16.4l-11.9-18.9l-18,19l-6-11.9l-18.4-16.7l-12.1-19.2l-18.3,19.4l-6.2-12l-18.7-17 l-12.3-19.5l-18.6,19.8l-6.3-12.2l-19-17.3l-12.5-19.8l-18.9,20.2l-6.5-12.3l-19.3-17.6l-12.7-20.1l-19.2,20.6 l-6.7-12.5l-19.6-17.9l-12.9-20.4l-19.5,21l-6.8-12.6l-19.9-18.2l-13.1-20.7l-19.8,21.4l-7-12.8l-20.2-18.5l-13.3-21 l-20.1,21.8l-7.2-12.9l-20.5-18.8l-13.5-21.3l-20.4,22.2l-7.3-13.1l-20.8-19.1l-13.7-21.6l-20.7,22.6l-7.5-13.2 l-21.1-19.4l-13.9-21.9l-21,23l-7.7-13.4l-21.4-19.7l-14.1-22.2l-21.3,23.4l-7.8-13.5l-21.7-20l-14.3-22.5l-21.6,23.8 l-8-13.7l-22-20.3l-14.5-22.8l-21.9,24.2l-8.2-13.8l-22.3-20.6l-14.7-23.1l-22.2,24.6l-8.3-14l-22.6-20.9l-14.9-23.4 l-22.5,25l-8.5-14.1l-22.9-21.2l-15.1-23.7l-22.8,25.4l-8.7-14.3l-23.2-21.5l-15.3-24l-23.1,25.8l-8.8-14.4l-23.5-21.8 l-15.5-24.3l-23.4,26.2l-9-14.6l-23.8-22.1l-15.7-24.6l-23.7,26.6l-9.2-14.7l-24.1-22.4l-15.9-24.9l-24,27l-9.3-14.9 l-24.4-22.7l-16.1-25.2l-24.3,27.4l-9.5-15l-24.7-23l-16.3-25.5l-24.6,27.8l-9.7-15.2l-25-23.3l-16.5-25.8l-24.9,28.2 l-9.8-15.3l-25.3-23.6l-16.7-26.1l-25.2,28.6l-10-15.5l-25.6-23.9l-16.9-26.4l-25.5,29l-10.2-15.6l-25.9-24.2 l-17.1-26.7l-25.8,29.4l-10.3-15.8l-26.2-24.5l-17.3-27l-26.1,29.8l-10.5-15.9l-26.5-24.8l-17.5-27.3l-26.4,30.2 l-10.7-16.1l-26.8-25.1l-17.7-27.6l-26.7,30.6l-10.8-16.2l-27.1-25.4l-17.9-27.9l-27,31l-11-16.4l-27.4-25.7 l-18.1-28.2l-27.3,31.4l-11.2-16.5l-27.7-26l-18.3-28.5l-27.6,31.8l-11.3-16.7l-28-26.3l-18.5-28.8l-27.9,32.2 l-11.5-16.8l-28.3-26.6l-18.7-29.1l-28.2,32.6l-11.7-17l-28.6-26.9l-18.9-29.4l-28.5,33l-11.8-17.1l-28.9-27.2 l-19.1-29.7l-28.8,33.4l-12-17.3l-29.2-27.5l-19.3-30l-29.1,33.8l-12.2-17.4l-29.5-27.8l-19.5-30.3l-29.4,34.2 l-12.3-17.6l-29.8-28.1l-19.7-30.6l-29.7,34.6l-12.5-17.7l-30.1-28.4l-19.9-30.9l-30,35l-12.7-17.9l-30.4-28.7 l-20.1-31.2l-30.3,35.4l-12.8-18l-30.7-29l-20.3-31.5l-30.6,35.8l-13-18.2l-31-29.3l-20.5-31.8l-30.9,36.2l-13.2-18.3 l-31.3-29.6l-20.7-32.1l-31.2,36.6l-13.3-18.5l-31.6-29.9l-20.9-32.4l-31.5,37l-13.5-18.6l-31.9-30.2l-21.1-32.7 l-31.8,37.4l-13.7-18.8l-32.2-30.5l-21.3-33l-32.1,37.8l-13.8-18.9l-32.5-30.8l-21.5-33.3l-32.4,38.2l-14-19.1 l-32.8-31.1l-21.7-33.6l-32.7,38.6l-14.2-19.2l-33.1-31.4l-21.9-33.9l-33,39l-14.3-19.4l-33.4-31.7l-22.1-34.2 l-33.3,39.4l-14.5-19.5l-33.7-32l-22.3-34.5l-33.6,39.8l-14.7-19.7l-34-32.3l-22.5-34.8l-33.9,40.2l-14.8-19.8 l-34.3-32.6l-22.7-35.1l-34.2,40.6l-15-20l-34.6-32.9l-22.9-35.4l-34.5,41l-15.2-20.1l-34.9-33.2l-23.1-35.7 l-34.8,41.4l-15.3-20.3l-35.2-33.5l-23.3-36l-35.1,41.8l-15.5-20.4l-35.5-33.8l-23.5-36.3l-35.4,42.2l-15.7-20.6 l-35.8-34.1l-23.7-36.6l-35.7,42.6l-15.8-20.7l-36.1-34.4l-23.9-36.9l-36,43l-16-20.9l-36.4-34.7l-24.1-37.2 l-36.3,43.4l-16.2-21l-36.7-35l-24.3-37.5l-36.6,43.8l-16.3-21.2l-37-35.3l-24.5-37.8l-36.9,44.2l-16.5-21.3 l-37.3-35.6l-24.7-38.1l-37.2,44.6l-16.7-21.5l-37.6-35.9l-24.9-38.4l-37.5,45l-16.8-21.6l-37.9-36.2l-25.1-38.7 l-37.8,45.4l-17-21.8l-38.2-36.5l-25.3-39l-38.1,45.8l-17.2-21.9l-38.5-36.8l-25.5-39.3l-38.4,46.2l-17.3-22.1 l-38.8-37.1l-25.7-39.6l-38.7,46.6l-17.5-22.2l-39.1-37.4l-25.9-39.9l-39,47l-17.7-22.4l-39.4-37.7l-26.1-40.2 l-39.3,47.4l-17.8-22.5l-39.7-38l-26.3-40.5l-39.6,47.8l-18-22.7l-40-38.3l-26.5-40.8l-39.9,48.2l-18.2-22.8 l-40.3-38.6l-26.7-41.1l-40.2,48.6l-18.3-23l-40.6-38.9l-26.9-41.4l-40.5,49l-18.5-23.1l-40.9-39.2l-27.1-41.7 l-40.8,49.4l-18.7-23.3l-41.2-39.5l-27.3-42l-41.1,49.8l-18.8-23.4l-41.5-39.8l-27.5-42.3l-41.4,50.2l-19-23.6 l-41.8-40.1l-27.7-42.6l-41.7,50.6l-19.2-23.7l-42.1-40.4l-27.9-42.9l-42,51l-19.3-23.9l-42.4-40.7l-28.1-43.2 l-42.3,51.4l-19.5-24l-42.7-41l-28.3-43.5l-42.6,51.8l-19.7-24.2l-43-41.3l-28.5-43.8l-42.9,52.2l-19.8-24.3 l-43.3-41.6l-28.7-44.1l-43.2,52.6l-20-24.5l-43.6-41.9l-28.9-44.4l-43.5,53l-20.2-24.6l-43.9-42.2l-29.1-44.7 l-43.8,53.4l-20.3-24.8l-44.2-42.5l-29.3-45l-44.1,53.8l-20.5-24.9l-44.5-42.8l-29.5-45.3l-44.4,54.2l-20.7-25.1 l-44.8-43.1l-29.7-45.6l-44.7,54.6l-20.8-25.2l-45.1-43.4l-29.9-45.9l-45,55l-21-25.4l-45.4-43.7l-30.1-46.2 l-45.3,55.4l";

export const VisitMapView: React.FC<VisitMapViewProps> = ({ attendedMatches }) => {
    const visitedVenues = useMemo(() => {
        const uniqueVenues = new Set(attendedMatches.map(am => am.match.venue));
        return Array.from(uniqueVenues);
    }, [attendedMatches]);

    return (
        <div className="relative w-full aspect-[4/5] max-w-lg mx-auto">
            <svg viewBox="0 0 500 800" className="w-full h-full">
                <path d={greatBritainPath} className="fill-surface-alt stroke-border/50" strokeWidth="0.5" />
                
                {Object.values(VENUE_LOCATIONS).map(venue => {
                    const isVisited = visitedVenues.includes(venue.name);
                    
                    // Filter out venues that are off the map coordinate system for clarity
                    if (venue.x > 500 || venue.y > 800) return null;

                    return (
                        <g key={venue.name} className="group cursor-pointer">
                            <circle 
                                cx={venue.x} 
                                cy={venue.y} 
                                r={isVisited ? 6 : 4}
                                className={`${isVisited ? 'fill-primary stroke-white dark:stroke-surface' : 'fill-text-subtle/50'} stroke-2 transition-all group-hover:fill-accent group-hover:r-6`}
                            />
                            <text
                                x={venue.x + 8}
                                y={venue.y + 4}
                                className="text-[10px] font-semibold fill-text-strong opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none select-none"
                            >
                                {venue.name}
                            </text>
                        </g>
                    )
                })}
            </svg>
        </div>
    );
};